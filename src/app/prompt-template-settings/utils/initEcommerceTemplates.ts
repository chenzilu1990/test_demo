import { createTag, loadTags } from './tagManager';
import { addTemplate } from './dataMigration';
import { ExtendedPromptTemplate } from '../types';

/**
 * åˆå§‹åŒ–è·¨å¢ƒç”µå•†æ¨¡æ¿å’Œæ ‡ç­¾
 */

// è·¨å¢ƒç”µå•†ç›¸å…³æ ‡ç­¾
const ECOMMERCE_TAGS = [
  { name: 'è·¨å¢ƒç”µå•†', color: 'bg-blue-500' },
  { name: 'äºšé©¬é€Š', color: 'bg-orange-500' },
  { name: 'äº§å“è¿è¥', color: 'bg-green-500' },
  { name: 'å¸‚åœºè°ƒç ”', color: 'bg-purple-500' },
  { name: 'è¥é”€æ¨å¹¿', color: 'bg-pink-500' },
  { name: 'å“ç‰Œå»ºè®¾', color: 'bg-indigo-500' },
  { name: 'SEOä¼˜åŒ–', color: 'bg-yellow-500' },
  { name: 'è¿è¥å”®å', color: 'bg-red-500' },
  { name: 'ä¾›åº”é“¾ç®¡ç†', color: 'bg-teal-500' },
  { name: 'ç‰©æµä»“å‚¨', color: 'bg-cyan-500' }
];

// è·¨å¢ƒç”µå•†æ¨¡æ¿æ•°æ®
const ECOMMERCE_TEMPLATES: Array<{
  title: string;
  prompt: string;
  parameterOptions: Record<string, string[]>;
  tags: string[];
}> = [
  {
    title: 'Amazonäº§å“æ ‡é¢˜ä¼˜åŒ–å™¨',
    prompt: `ä½œä¸ºäºšé©¬é€ŠSEOä¸“å®¶ï¼Œæˆ‘éœ€è¦ä¸ºäº§å“åˆ›å»ºä¼˜åŒ–çš„æ ‡é¢˜ã€‚è¯·æ ¹æ®ä»¥ä¸‹ä¿¡æ¯ç”Ÿæˆä¸€ä¸ª150-200å­—ç¬¦çš„äºšé©¬é€Šäº§å“æ ‡é¢˜ï¼š

äº§å“åç§°ï¼š{productName}
æ ¸å¿ƒå…³é”®è¯ï¼š{coreKeywords}
äº§å“ç‰¹ç‚¹ï¼š{features}
ç›®æ ‡å—ä¼—ï¼š{targetAudience}
äº§å“ç”¨é€”ï¼š{usage}

è¦æ±‚ï¼š
1. æ ‡é¢˜ä¸­å¿…é¡»åŒ…å«æ‰€æœ‰æ ¸å¿ƒå…³é”®è¯
2. çªå‡º3ä¸ªæœ€é‡è¦çš„å–ç‚¹
3. åŒ…å«2ä¸ªä¸»è¦ä½¿ç”¨åœºæ™¯
4. æ˜ç¡®ç›®æ ‡ç”¨æˆ·ç¾¤ä½“
5. ç¬¦åˆäºšé©¬é€Šæ ‡é¢˜è§„èŒƒ
6. å¸å¼•ç‚¹å‡»å’Œè½¬åŒ–

è¯·æä¾›5ä¸ªä¸åŒçš„æ ‡é¢˜é€‰é¡¹ï¼Œå¹¶è¯´æ˜æ¯ä¸ªæ ‡é¢˜çš„ä¼˜åŠ¿ã€‚`,
    parameterOptions: {
      productName: ['æ— çº¿è“ç‰™è€³æœº', 'LEDå°ç¯', 'ç‘œä¼½å«', 'å’–å•¡æ¯'],
      coreKeywords: ['wireless bluetooth earbuds', 'LED desk lamp', 'yoga mat', 'travel mug'],
      features: ['é˜²æ°´', 'é•¿ç»­èˆª', 'å¿«å……', 'é™å™ª', 'ä¾¿æº'],
      targetAudience: ['è¿åŠ¨çˆ±å¥½è€…', 'åŠå…¬äººç¾¤', 'å­¦ç”Ÿ', 'æ—…è¡Œè€…'],
      usage: ['å¥èº«æˆ¿', 'åŠå…¬å®¤', 'å±…å®¶', 'æ—…è¡Œ', 'æˆ·å¤–']
    },
    tags: ['è·¨å¢ƒç”µå•†', 'äºšé©¬é€Š', 'SEOä¼˜åŒ–', 'äº§å“è¿è¥']
  },
  {
    title: 'Amazonäº§å“5ç‚¹æè¿°ç”Ÿæˆå™¨',
    prompt: `ä½œä¸ºèµ„æ·±äºšé©¬é€Šå–å®¶ï¼Œè¯·æ ¹æ®ä»¥ä¸‹äº§å“ä¿¡æ¯ç¼–å†™Amazonäº§å“çš„5ç‚¹æè¿°ï¼ˆBullet Pointsï¼‰ï¼š

äº§å“åç§°ï¼š{productName}
äº§å“ç±»åˆ«ï¼š{category}
æ ¸å¿ƒåŠŸèƒ½ï¼š{coreFeatures}
æè´¨è§„æ ¼ï¼š{specifications}
ä½¿ç”¨åœºæ™¯ï¼š{useScenarios}
ç«äº‰ä¼˜åŠ¿ï¼š{advantages}

è¦æ±‚ï¼š
1. æ¯ç‚¹æ§åˆ¶åœ¨250å­—ç¬¦ä»¥å†…
2. ç¬¬ä¸€ç‚¹çªå‡ºæ ¸å¿ƒåŠŸèƒ½å’Œä¸»è¦å–ç‚¹
3. åŒ…å«å…³é”®è¯ä½†é¿å…å †ç Œ
4. ä½¿ç”¨æœ‰è¯´æœåŠ›çš„è¯­è¨€
5. çªå‡ºäº§å“ç‹¬ç‰¹æ€§å’Œç«äº‰ä¼˜åŠ¿
6. åŒ…å«æŠ€æœ¯å‚æ•°å’Œæè´¨ä¿¡æ¯
7. å‘¼åº”ç›®æ ‡å®¢æˆ·çš„ç—›ç‚¹

è¯·æŒ‰é‡è¦æ€§æ’åºè¾“å‡º5ä¸ªbullet pointsã€‚`,
    parameterOptions: {
      productName: ['è“ç‰™éŸ³ç®±', 'ç©ºæ°”å‡€åŒ–å™¨', 'æŒ‰æ‘©æ¤…', 'æ™ºèƒ½æ‰‹è¡¨'],
      category: ['ç”µå­äº§å“', 'å®¶å±…ç”¨å“', 'å¥åº·ç¾å®¹', 'è¿åŠ¨æˆ·å¤–'],
      coreFeatures: ['éŸ³è´¨æ¸…æ™°', 'é«˜æ•ˆå‡€åŒ–', 'æ·±åº¦æŒ‰æ‘©', 'å¥åº·ç›‘æµ‹'],
      specifications: ['é˜²æ°´IPX7', 'HEPAæ»¤ç½‘', 'é›¶é‡åŠ›è®¾è®¡', '50ç±³é˜²æ°´'],
      useScenarios: ['æˆ·å¤–é‡é¤', 'å§å®¤ç¡çœ ', 'åŠå…¬å‡å‹', 'è¿åŠ¨å¥èº«'],
      advantages: ['ç»­èˆª12å°æ—¶', '99.97%è¿‡æ»¤', '4DæŒ‰æ‘©æŠ€æœ¯', '7å¤©ç»­èˆª']
    },
    tags: ['è·¨å¢ƒç”µå•†', 'äºšé©¬é€Š', 'äº§å“è¿è¥', 'SEOä¼˜åŒ–']
  },
  {
    title: 'äº§å“å¸‚åœºæ´å¯Ÿåˆ†æå™¨',
    prompt: `ä½œä¸ºå¸‚åœºç ”ç©¶ä¸“å®¶ï¼Œè¯·å¯¹ä»¥ä¸‹äº§å“åœ¨ç›®æ ‡å¸‚åœºçš„æ¶ˆè´¹è€…è¡Œä¸ºè¿›è¡Œæ·±åº¦åˆ†æï¼š

äº§å“ç±»åˆ«ï¼š{productCategory}
ç›®æ ‡å¸‚åœºï¼š{targetMarket}
ä»·æ ¼åŒºé—´ï¼š{priceRange}
é”€å”®å¹³å°ï¼š{platform}
ç«äº‰ç¯å¢ƒï¼š{competition}

è¯·ä»ä»¥ä¸‹ç»´åº¦è¿›è¡Œåˆ†æï¼š

**1. ç›®æ ‡ç”¨æˆ·ç”»åƒ**
- å¹´é¾„ã€æ€§åˆ«ã€æ”¶å…¥æ°´å¹³
- ç”Ÿæ´»æ–¹å¼å’Œæ¶ˆè´¹ä¹ æƒ¯
- è´­ä¹°å†³ç­–å› ç´ 

**2. ä½¿ç”¨åœºæ™¯åˆ†æ**
- ä¸»è¦ä½¿ç”¨åœºæ™¯
- è´­ä¹°æ—¶æœºå’Œé¢‘ç‡
- å­£èŠ‚æ€§å½±å“

**3. ç”¨æˆ·ç—›ç‚¹å’Œéœ€æ±‚**
- å½“å‰è§£å†³æ–¹æ¡ˆçš„ä¸è¶³
- æœªè¢«æ»¡è¶³çš„éœ€æ±‚
- æ½œåœ¨çš„æ–°éœ€æ±‚

**4. å¸‚åœºæœºä¼šå’Œå»ºè®®**
- äº§å“ä¼˜åŒ–æ–¹å‘
- è¥é”€ç­–ç•¥å»ºè®®
- å®šä»·ç­–ç•¥å»ºè®®

è¯·æä¾›å…·ä½“ä¸”å¯æ“ä½œçš„æ´å¯Ÿã€‚`,
    parameterOptions: {
      productCategory: ['æ™ºèƒ½å®¶å±…', 'ç¾å®¹æŠ¤è‚¤', 'å¥èº«å™¨æ', 'å¨æˆ¿ç”¨å“', 'å® ç‰©ç”¨å“'],
      targetMarket: ['ç¾å›½', 'æ¬§æ´²', 'æ—¥æœ¬', 'æ¾³æ´²', 'ä¸œå—äºš'],
      priceRange: ['10-30ç¾å…ƒ', '30-100ç¾å…ƒ', '100-300ç¾å…ƒ', '300ç¾å…ƒä»¥ä¸Š'],
      platform: ['Amazon', 'eBay', 'Shopifyç‹¬ç«‹ç«™', 'å¤šå¹³å°'],
      competition: ['æ¿€çƒˆ', 'ä¸­ç­‰', 'è¾ƒå°‘', 'è“æµ·å¸‚åœº']
    },
    tags: ['è·¨å¢ƒç”µå•†', 'å¸‚åœºè°ƒç ”', 'äº§å“è¿è¥', 'è¥é”€æ¨å¹¿']
  },
  {
    title: 'Amazonå¹¿å‘Šå…³é”®è¯ç­–ç•¥å¸ˆ',
    prompt: `ä½œä¸ºAmazon PPCå¹¿å‘Šä¸“å®¶ï¼Œè¯·ä¸ºä»¥ä¸‹äº§å“åˆ¶å®šå…¨é¢çš„å…³é”®è¯å¹¿å‘Šç­–ç•¥ï¼š

äº§å“åç§°ï¼š{productName}
äº§å“ç±»åˆ«ï¼š{category}
ä¸»è¦ç‰¹å¾ï¼š{mainFeatures}
ç›®æ ‡å®¢æˆ·ï¼š{targetCustomer}
é¢„ç®—èŒƒå›´ï¼š{budget}
ç«äº‰ç¨‹åº¦ï¼š{competitionLevel}

è¯·æä¾›ä»¥ä¸‹å…³é”®è¯ç­–ç•¥ï¼š

**1. æ ¸å¿ƒå…³é”®è¯ï¼ˆ5-8ä¸ªï¼‰**
- æœç´¢é‡å¤§ã€è½¬åŒ–ç‡é«˜çš„ä¸»è¦å…³é”®è¯
- å»ºè®®å‡ºä»·èŒƒå›´

**2. é•¿å°¾å…³é”®è¯ï¼ˆ10-15ä¸ªï¼‰**
- ç²¾å‡†åº¦é«˜ã€ç«äº‰è¾ƒå°çš„é•¿å°¾è¯
- é€‚åˆçš„åŒ¹é…ç±»å‹

**3. ç«å“å…³é”®è¯ï¼ˆ3-5ä¸ªï¼‰**
- ä¸»è¦ç«äº‰å¯¹æ‰‹å“ç‰Œè¯
- æŠ•æ”¾ç­–ç•¥å»ºè®®

**4. é˜²å¾¡æ€§å…³é”®è¯ï¼ˆ3-5ä¸ªï¼‰**
- ä¿æŠ¤è‡ªå·±å“ç‰Œçš„å…³é”®è¯
- é¿å…è¢«ç«äº‰å¯¹æ‰‹æˆªæµ

**5. å¦å®šå…³é”®è¯åˆ—è¡¨**
- é¿å…æ— æ•ˆç‚¹å‡»çš„å¦å®šè¯

**6. å‡ºä»·ç­–ç•¥å»ºè®®**
- ä¸åŒé˜¶æ®µçš„å‡ºä»·ç­–ç•¥
- ä¼˜åŒ–å»ºè®®

è¯·æä¾›å…·ä½“çš„æ‰§è¡Œæ–¹æ¡ˆã€‚`,
    parameterOptions: {
      productName: ['æ— çº¿å……ç”µå™¨', 'ç‘œä¼½æœè£…', 'å’–å•¡æœº', 'å® ç‰©ç©å…·'],
      category: ['ç”µå­é…ä»¶', 'è¿åŠ¨æœé¥°', 'å°å®¶ç”µ', 'å® ç‰©ç”¨å“'],
      mainFeatures: ['å¿«é€Ÿå……ç”µ', 'é€æ°”èˆ’é€‚', 'ä¸€é”®æ“ä½œ', 'è€å’¬å®‰å…¨'],
      targetCustomer: ['å•†åŠ¡äººå£«', 'å¥èº«çˆ±å¥½è€…', 'å’–å•¡çˆ±å¥½è€…', 'å® ç‰©ä¸»äºº'],
      budget: ['æ¯æ—¥50ç¾å…ƒ', 'æ¯æ—¥100ç¾å…ƒ', 'æ¯æ—¥200ç¾å…ƒ', 'æ¯æ—¥500ç¾å…ƒ'],
      competitionLevel: ['é«˜ç«äº‰', 'ä¸­ç­‰ç«äº‰', 'ä½ç«äº‰']
    },
    tags: ['è·¨å¢ƒç”µå•†', 'äºšé©¬é€Š', 'è¥é”€æ¨å¹¿', 'SEOä¼˜åŒ–']
  },
  {
    title: 'äº§å“å·®å¼‚åŒ–å®šä½åˆ†æå¸ˆ',
    prompt: `ä½œä¸ºäº§å“ç­–ç•¥ä¸“å®¶ï¼Œè¯·å¸®åŠ©åˆ†æäº§å“çš„å·®å¼‚åŒ–å®šä½ç­–ç•¥ï¼š

äº§å“åç§°ï¼š{productName}
äº§å“ç±»åˆ«ï¼š{category}
ä¸»è¦åŠŸèƒ½ï¼š{mainFunction}
ç›®æ ‡å¸‚åœºï¼š{targetMarket}
ä¸»è¦ç«å“ï¼š{competitors}
æˆæœ¬é™åˆ¶ï¼š{costConstraint}

è¯·ä»ä»¥ä¸‹è§’åº¦è¿›è¡Œå·®å¼‚åŒ–åˆ†æï¼š

**1. åŠŸèƒ½å·®å¼‚åŒ–**
- ç‹¬ç‰¹åŠŸèƒ½ç‚¹
- æŠ€æœ¯åˆ›æ–°æ–¹å‘
- æ€§èƒ½æå‡å»ºè®®

**2. è®¾è®¡å·®å¼‚åŒ–**
- å¤–è§‚è®¾è®¡åˆ›æ–°
- ç”¨æˆ·ä½“éªŒä¼˜åŒ–
- åŒ…è£…è®¾è®¡å»ºè®®

**3. ä»·æ ¼å·®å¼‚åŒ–**
- ä»·æ ¼å®šä½ç­–ç•¥
- æˆæœ¬ä¼˜åŒ–æ–¹æ¡ˆ
- ä»·å€¼æ„ŸçŸ¥æå‡

**4. æœåŠ¡å·®å¼‚åŒ–**
- å”®å‰æœåŠ¡åˆ›æ–°
- å”®åæœåŠ¡ä¼˜åŠ¿
- å®¢æˆ·ä½“éªŒæå‡

**5. è¥é”€å·®å¼‚åŒ–**
- ç‹¬ç‰¹å–ç‚¹æç‚¼
- ç›®æ ‡å®¢ç¾¤ç»†åˆ†
- ä¼ æ’­ç­–ç•¥å»ºè®®

**6. æ¸ é“å·®å¼‚åŒ–**
- é”€å”®æ¸ é“åˆ›æ–°
- åˆ†é”€ç­–ç•¥ä¼˜åŒ–

è¯·æä¾›å…·ä½“å¯æ‰§è¡Œçš„å·®å¼‚åŒ–æ–¹æ¡ˆã€‚`,
    parameterOptions: {
      productName: ['è“ç‰™è€³æœº', 'æ™ºèƒ½æ‰‹ç¯', 'ç©ºæ°”ç‚¸é”…', 'åŒ–å¦†é•œ'],
      category: ['æ•°ç é…ä»¶', 'å¯ç©¿æˆ´è®¾å¤‡', 'å¨æˆ¿ç”µå™¨', 'ç¾å®¹å·¥å…·'],
      mainFunction: ['éŸ³ä¹æ’­æ”¾', 'å¥åº·ç›‘æµ‹', 'å¥åº·çƒ¹é¥ª', 'åŒ–å¦†ç…§æ˜'],
      targetMarket: ['æ¬§ç¾å¸‚åœº', 'äºšæ´²å¸‚åœº', 'å…¨çƒå¸‚åœº'],
      competitors: ['Apple AirPods', 'Fitbit', 'Ninja Foodi', 'å…¶ä»–å“ç‰Œ'],
      costConstraint: ['æˆæœ¬æ•æ„Ÿ', 'ä¸­ç­‰æˆæœ¬', 'é«˜ç«¯å®šä½']
    },
    tags: ['è·¨å¢ƒç”µå•†', 'äº§å“è¿è¥', 'å“ç‰Œå»ºè®¾', 'å¸‚åœºè°ƒç ”']
  },
  {
    title: 'å®¢æˆ·è¯„ä»·å›å¤æ¨¡æ¿ç”Ÿæˆå™¨',
    prompt: `ä½œä¸ºä¸“ä¸šçš„å®¢æˆ·æœåŠ¡ä¸“å®¶ï¼Œè¯·ä¸ºä»¥ä¸‹æƒ…å†µç”Ÿæˆåˆé€‚çš„è¯„ä»·å›å¤æ¨¡æ¿ï¼š

è¯„ä»·ç±»å‹ï¼š{reviewType}
è¯„ä»·æ˜Ÿçº§ï¼š{rating}
äº§å“ç±»åˆ«ï¼š{productCategory}
ä¸»è¦é—®é¢˜ï¼š{mainIssue}
å®¢æˆ·æƒ…ç»ªï¼š{customerEmotion}
è§£å†³æ–¹æ¡ˆï¼š{solution}

è¯·ç”Ÿæˆä¸€ä¸ªä¸“ä¸šã€çœŸè¯šä¸”æœ‰æ•ˆçš„å›å¤ï¼Œè¦æ±‚ï¼š

**å›å¤åŸåˆ™ï¼š**
1. çœŸè¯šæ„Ÿè°¢å®¢æˆ·åé¦ˆ
2. æ‰¿è®¤é—®é¢˜ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
3. æä¾›å…·ä½“è§£å†³æ–¹æ¡ˆ
4. é‚€è¯·è¿›ä¸€æ­¥æ²Ÿé€š
5. å±•ç°å“ç‰Œä¸“ä¸šå½¢è±¡

**å›å¤ç»“æ„ï¼š**
- å¼€å¤´ï¼šæ„Ÿè°¢å’Œé—®å€™
- ä¸­é—´ï¼šå›åº”å…·ä½“é—®é¢˜
- ç»“å°¾ï¼šåç»­æ”¯æŒæ‰¿è¯º

**è¯­è¨€è¦æ±‚ï¼š**
- ä¸“ä¸šä½†ä¸å¤±æ¸©åº¦
- ç®€æ´æ˜äº†ï¼Œé¿å…æ¨¡æ¿åŒ–
- ä½“ç°å“ç‰Œä»·å€¼è§‚
- ç¬¦åˆå¹³å°è§„èŒƒ

è¯·ç”Ÿæˆè‹±æ–‡å›å¤ï¼Œå¹¶æä¾›ä¸­æ–‡è¯´æ˜ã€‚`,
    parameterOptions: {
      reviewType: ['æ­£é¢è¯„ä»·', 'è´Ÿé¢è¯„ä»·', 'ä¸­æ€§è¯„ä»·', 'äº§å“é—®é¢˜', 'ç‰©æµé—®é¢˜'],
      rating: ['5æ˜Ÿå¥½è¯„', '4æ˜Ÿå¥½è¯„', '3æ˜Ÿä¸­è¯„', '2æ˜Ÿå·®è¯„', '1æ˜Ÿå·®è¯„'],
      productCategory: ['ç”µå­äº§å“', 'æœè£…é…é¥°', 'å®¶å±…ç”¨å“', 'ç¾å®¹æŠ¤è‚¤'],
      mainIssue: ['äº§å“è´¨é‡', 'ç‰©æµå»¶è¿Ÿ', 'åŒ…è£…ç ´æŸ', 'ä½¿ç”¨å›°éš¾', 'æœŸæœ›ä¸ç¬¦'],
      customerEmotion: ['æ»¡æ„', 'å¤±æœ›', 'æ„¤æ€’', 'ç–‘æƒ‘', 'ä¸­æ€§'],
      solution: ['å…è´¹æ›´æ¢', 'é€€æ¬¾å¤„ç†', 'æŠ€æœ¯æ”¯æŒ', 'è¡¥å¿ä¼˜æƒ ', 'æµç¨‹æ”¹è¿›']
    },
    tags: ['è·¨å¢ƒç”µå•†', 'è¿è¥å”®å', 'äºšé©¬é€Š', 'å“ç‰Œå»ºè®¾']
  },
  {
    title: 'FBAåº“å­˜ç®¡ç†ç­–ç•¥é¡¾é—®',
    prompt: `ä½œä¸ºAmazon FBAè¿è¥ä¸“å®¶ï¼Œè¯·ä¸ºä»¥ä¸‹äº§å“åˆ¶å®šåº“å­˜ç®¡ç†ç­–ç•¥ï¼š

äº§å“åç§°ï¼š{productName}
é”€å”®å†å²ï¼š{salesHistory}
å­£èŠ‚æ€§ç‰¹å¾ï¼š{seasonality}
åº“å­˜å‘¨è½¬ï¼š{inventoryTurnover}
èµ„é‡‘çŠ¶å†µï¼š{cashFlow}
ä¾›åº”å•†æƒ…å†µï¼š{supplierInfo}
ç«äº‰ç¯å¢ƒï¼š{competition}

è¯·æä¾›å®Œæ•´çš„åº“å­˜ç®¡ç†æ–¹æ¡ˆï¼š

**1. åº“å­˜é¢„æµ‹åˆ†æ**
- åŸºäºå†å²æ•°æ®çš„é”€é‡é¢„æµ‹
- å­£èŠ‚æ€§è°ƒæ•´å› å­
- å¸‚åœºè¶‹åŠ¿å½±å“è¯„ä¼°

**2. å®‰å…¨åº“å­˜è®¡ç®—**
- æœ€ä½åº“å­˜é˜ˆå€¼
- è¡¥è´§ç‚¹è®¾ç½®
- ç¼ºè´§é£é™©è¯„ä¼°

**3. é‡‡è´­è®¡åˆ’åˆ¶å®š**
- é‡‡è´­æ•°é‡å»ºè®®
- é‡‡è´­æ—¶é—´èŠ‚ç‚¹
- ä¾›åº”å•†ç®¡ç†ç­–ç•¥

**4. æˆæœ¬ä¼˜åŒ–æ–¹æ¡ˆ**
- FBAè´¹ç”¨ä¼˜åŒ–
- å­˜å‚¨æˆæœ¬æ§åˆ¶
- èµ„é‡‘å‘¨è½¬æ”¹å–„

**5. é£é™©ç®¡æ§æªæ–½**
- æ»é”€åº“å­˜å¤„ç†
- æ–­è´§åº”æ€¥é¢„æ¡ˆ
- å¤šä»“å‚¨å¤‡ç­–ç•¥

**6. ç»©æ•ˆç›‘æ§æŒ‡æ ‡**
- å…³é”®KPIè®¾å®š
- ç›‘æ§é¢‘ç‡å»ºè®®
- è°ƒæ•´è§¦å‘æ¡ä»¶

è¯·æä¾›å…·ä½“å¯æ‰§è¡Œçš„ç®¡ç†æ–¹æ¡ˆã€‚`,
    parameterOptions: {
      productName: ['å­£èŠ‚æ€§ç©å…·', 'è¿åŠ¨å™¨æ', 'å®¶å±…è£…é¥°', 'ç”µå­é…ä»¶'],
      salesHistory: ['ç¨³å®šå¢é•¿', 'æ³¢åŠ¨è¾ƒå¤§', 'æ–°å“ä¸Šå¸‚', 'æˆç†Ÿäº§å“'],
      seasonality: ['å¼ºå­£èŠ‚æ€§', 'å¼±å­£èŠ‚æ€§', 'æ— å­£èŠ‚æ€§', 'åå­£èŠ‚æ€§'],
      inventoryTurnover: ['é«˜å‘¨è½¬(>12æ¬¡/å¹´)', 'ä¸­å‘¨è½¬(6-12æ¬¡/å¹´)', 'ä½å‘¨è½¬(<6æ¬¡/å¹´)'],
      cashFlow: ['èµ„é‡‘å……è¶³', 'èµ„é‡‘ç´§å¼ ', 'ç°é‡‘æµæ­£å¸¸'],
      supplierInfo: ['ç¨³å®šä¾›åº”å•†', 'å¤šä¸ªä¾›åº”å•†', 'æ–°ä¾›åº”å•†', 'ä¾›åº”ä¸ç¨³'],
      competition: ['æ¿€çƒˆç«äº‰', 'ä¸­ç­‰ç«äº‰', 'ç›¸å¯¹å„æ–­']
    },
    tags: ['è·¨å¢ƒç”µå•†', 'äºšé©¬é€Š', 'ä¾›åº”é“¾ç®¡ç†', 'ç‰©æµä»“å‚¨']
  }
];

// åˆ›å»ºæ ‡ç­¾çš„è¾…åŠ©å‡½æ•°
export const createEcommerceTags = (): string[] => {
  const existingTags = loadTags();
  const createdTagIds: string[] = [];

  for (const tagData of ECOMMERCE_TAGS) {
    try {
      // æ£€æŸ¥æ ‡ç­¾æ˜¯å¦å·²å­˜åœ¨
      const existing = existingTags.find(tag => tag.name === tagData.name);
      if (existing) {
        createdTagIds.push(existing.id);
        console.log(`æ ‡ç­¾ "${tagData.name}" å·²å­˜åœ¨ï¼Œè·³è¿‡åˆ›å»º`);
        continue;
      }

      // åˆ›å»ºæ–°æ ‡ç­¾
      const newTag = createTag(tagData.name, tagData.color);
      createdTagIds.push(newTag.id);
      console.log(`æˆåŠŸåˆ›å»ºæ ‡ç­¾: ${tagData.name}`);
    } catch (error) {
      console.error(`åˆ›å»ºæ ‡ç­¾ "${tagData.name}" å¤±è´¥:`, error);
    }
  }

  return createdTagIds;
};

// åˆ›å»ºæ¨¡æ¿çš„è¾…åŠ©å‡½æ•°
export const createEcommerceTemplates = (tagIds: Record<string, string>): ExtendedPromptTemplate[] => {
  const createdTemplates: ExtendedPromptTemplate[] = [];

  for (const templateData of ECOMMERCE_TEMPLATES) {
    try {
      // å°†æ ‡ç­¾åç§°è½¬æ¢ä¸ºæ ‡ç­¾ID
      const templateTagIds = templateData.tags.map(tagName => tagIds[tagName]).filter(Boolean);

             const newTemplate = addTemplate({
         title: templateData.title,
         prompt: templateData.prompt,
         parameterOptions: templateData.parameterOptions,
         tags: templateTagIds
       });

      createdTemplates.push(newTemplate);
      console.log(`æˆåŠŸåˆ›å»ºæ¨¡æ¿: ${templateData.title}`);
    } catch (error) {
      console.error(`åˆ›å»ºæ¨¡æ¿ "${templateData.title}" å¤±è´¥:`, error);
    }
  }

  return createdTemplates;
};

// ä¸»åˆå§‹åŒ–å‡½æ•°
export const initializeEcommerceTemplates = (): {
  tags: string[];
  templates: ExtendedPromptTemplate[];
  summary: string;
} => {
  console.log('å¼€å§‹åˆå§‹åŒ–è·¨å¢ƒç”µå•†æ¨¡æ¿å’Œæ ‡ç­¾...');

  // 1. åˆ›å»ºæ ‡ç­¾
  const createdTagIds = createEcommerceTags();
  
  // 2. åˆ›å»ºæ ‡ç­¾åç§°åˆ°IDçš„æ˜ å°„
  const allTags = loadTags();
  const tagNameToId: Record<string, string> = {};
  allTags.forEach(tag => {
    tagNameToId[tag.name] = tag.id;
  });

  // 3. åˆ›å»ºæ¨¡æ¿
  const createdTemplates = createEcommerceTemplates(tagNameToId);

  const summary = `
ğŸ‰ è·¨å¢ƒç”µå•†æ¨¡æ¿åˆå§‹åŒ–å®Œæˆï¼

ğŸ“Š åˆ›å»ºç»Ÿè®¡:
â€¢ æ ‡ç­¾: ${ECOMMERCE_TAGS.length} ä¸ª (æ–°å»º ${createdTagIds.length} ä¸ª)
â€¢ æ¨¡æ¿: ${ECOMMERCE_TEMPLATES.length} ä¸ª (æˆåŠŸåˆ›å»º ${createdTemplates.length} ä¸ª)

ğŸ·ï¸ åˆ›å»ºçš„æ ‡ç­¾:
${ECOMMERCE_TAGS.map(tag => `â€¢ ${tag.name}`).join('\n')}

ğŸ“ åˆ›å»ºçš„æ¨¡æ¿:
${ECOMMERCE_TEMPLATES.map(template => `â€¢ ${template.title}`).join('\n')}

âœ… æ‰€æœ‰æ¨¡æ¿éƒ½å·²é…ç½®å¥½å‚æ•°é€‰é¡¹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼
`;

  console.log(summary);

  return {
    tags: createdTagIds,
    templates: createdTemplates,
    summary
  };
}; 